!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(b){var n={pairs:"()[]{}''\"\"",closeBefore:")]}'\":;>",triples:"",explode:"[]{}"},x=b.Pos;function k(e,t){return"pairs"==t&&"string"==typeof e?e:("object"==typeof e&&null!=e[t]?e:n)[t]}b.defineOption("autoCloseBrackets",!1,function(e,t,n){n&&n!=b.Init&&(e.removeKeyMap(i),e.state.closeBrackets=null),t&&(r(k(t,"pairs")),e.state.closeBrackets=t,e.addKeyMap(i))});var i={Backspace:function(e){var t=C(e);if(!t||e.getOption("disableInput"))return b.Pass;for(var n=k(t,"pairs"),r=e.listSelections(),i=0;i<r.length;i++){if(!r[i].empty())return b.Pass;var o=s(e,r[i].head);if(!o||n.indexOf(o)%2!=0)return b.Pass}for(i=r.length-1;0<=i;i--){var a=r[i].head;e.replaceRange("",x(a.line,a.ch-1),x(a.line,a.ch+1),"+delete")}},Enter:function(r){var e=C(r),t=e&&k(e,"explode");if(!t||r.getOption("disableInput"))return b.Pass;for(var i=r.listSelections(),n=0;n<i.length;n++){if(!i[n].empty())return b.Pass;var o=s(r,i[n].head);if(!o||t.indexOf(o)%2!=0)return b.Pass}r.operation(function(){var e=r.lineSeparator()||"\n";r.replaceSelection(e+e,null),T(r,-1),i=r.listSelections();for(var t=0;t<i.length;t++){var n=i[t].head.line;r.indentLine(n,null,!0),r.indentLine(n+1,null,!0)}})}};function r(e){for(var t=0;t<e.length;t++){var n=e.charAt(t),r="'"+n+"'";i[r]||(i[r]=function(y){return function(e){var i=e,t=y,e=C(i);if(!e||i.getOption("disableInput"))return b.Pass;var n=k(e,"pairs"),r=n.indexOf(t);if(-1==r)return b.Pass;for(var o,a=k(e,"closeBefore"),s=k(e,"triples"),c=n.charAt(r+1)==t,l=i.listSelections(),f=r%2==0,h=0;h<l.length;h++){var d,u=l[h],g=u.head,m=i.getRange(g,x(g.line,g.ch+1));if(f&&!u.empty())d="surround";else if(!c&&f||m!=t)if(c&&1<g.ch&&0<=s.indexOf(t)&&i.getRange(x(g.line,g.ch-2),g)==t+t){if(2<g.ch&&/\bstring/.test(i.getTokenTypeAt(x(g.line,g.ch-2))))return b.Pass;d="addFour"}else{if(c){u=0==g.ch?" ":i.getRange(x(g.line,g.ch-1),g);if(b.isWordChar(m)||u==t||b.isWordChar(u))return b.Pass}else if(!f||!(0===m.length||/\s/.test(m)||-1<a.indexOf(m)))return b.Pass;d="both"}else d=c&&function(e,t){var n=e.getTokenAt(x(t.line,t.ch+1));return/\bstring/.test(n.type)&&n.start==t.ch&&(0==t.ch||!/\bstring/.test(e.getTokenTypeAt(t)))}(i,g)?"both":0<=s.indexOf(t)&&i.getRange(g,x(g.line,g.ch+3))==t+t+t?"skipThree":"skip";if(o){if(o!=d)return b.Pass}else o=d}var p=r%2?n.charAt(r-1):t,v=r%2?t:n.charAt(r+1);i.operation(function(){if("skip"==o)T(i,1);else if("skipThree"==o)T(i,3);else if("surround"==o){for(var e=i.getSelections(),t=0;t<e.length;t++)e[t]=p+e[t]+v;i.replaceSelections(e,"around");for(e=i.listSelections().slice(),t=0;t<e.length;t++)e[t]=(n=e[t],r=void 0,r=0<b.cmpPos(n.anchor,n.head),{anchor:new x(n.anchor.line,n.anchor.ch+(r?-1:1)),head:new x(n.head.line,n.head.ch+(r?1:-1))});i.setSelections(e)}else"both"==o?(i.replaceSelection(p+v,null),i.triggerElectric(p+v),T(i,-1)):"addFour"==o&&(i.replaceSelection(p+p+p+p,"before"),T(i,1));var n,r})}}(n))}}function C(e){var t=e.state.closeBrackets;return t&&!t.override&&e.getModeAt(e.getCursor()).closeBrackets||t}function T(e,t){for(var n=[],r=e.listSelections(),i=0,o=0;o<r.length;o++){var a=r[o],a=(a.head==e.getCursor()&&(i=o),a.head.ch||0<t?{line:a.head.line,ch:a.head.ch+t}:{line:a.head.line-1});n.push({anchor:a,head:a})}e.setSelections(n,i)}function s(e,t){e=e.getRange(x(t.line,t.ch-1),x(t.line,t.ch+1));return 2==e.length?e:null}r(n.pairs+"`")}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("../fold/xml-fold")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../fold/xml-fold"],e):e(CodeMirror)}(function(y){y.defineOption("autoCloseTags",!1,function(e,t,n){n!=y.Init&&n&&e.removeKeyMap("autoCloseTags"),t&&(n={name:"autoCloseTags"},"object"==typeof t&&!1===t.whenClosing||(n["'/'"]=function(e){return(e=e).getOption("disableInput")?y.Pass:r(e,!0)}),"object"==typeof t&&!1===t.whenOpening||(n["'>'"]=function(e){var t=e;if(t.getOption("disableInput"))return y.Pass;for(var n=t.listSelections(),r=[],i=t.getOption("autoCloseTags"),o=0;o<n.length;o++){if(!n[o].empty())return y.Pass;var a=n[o].head,s=t.getTokenAt(a),c=y.innerMode(t.getMode(),s.state),l=c.state,f=c.mode.xmlCurrentTag&&c.mode.xmlCurrentTag(l),h=f&&f.name;if(!h)return y.Pass;var d="html"==c.mode.configuration,u="object"==typeof i&&i.dontCloseTags||d&&b,d="object"==typeof i&&i.indentTags||d&&x,g=(h=s.end>a.ch?h.slice(0,h.length-s.end+a.ch):h).toLowerCase();if(!h||"string"==s.type&&(s.end!=a.ch||!/[\"\']/.test(s.string.charAt(s.string.length-1))||1==s.string.length)||"tag"==s.type&&f.close||s.string.indexOf("/")==a.ch-s.start-1||u&&-1<k(u,g)||C(t,c.mode.xmlCurrentContext&&c.mode.xmlCurrentContext(l)||[],h,a,!0))return y.Pass;f="object"==typeof i&&i.emptyTags;f&&-1<k(f,h)?r[o]={text:"/>",newPos:y.Pos(a.line,a.ch+2)}:(s=d&&-1<k(d,g),r[o]={indent:s,text:">"+(s?"\n\n":"")+"</"+h+">",newPos:s?y.Pos(a.line+1,0):y.Pos(a.line,a.ch+1)})}for(var m="object"==typeof i&&i.dontIndentOnAutoClose,o=n.length-1;0<=o;o--){var p=r[o],v=(t.replaceRange(p.text,n[o].head,n[o].anchor,"+insert"),t.listSelections().slice(0));v[o]={head:p.newPos,anchor:p.newPos},t.setSelections(v),!m&&p.indent&&(t.indentLine(p.newPos.line,null,!0),t.indentLine(p.newPos.line+1,null,!0))}}),e.addKeyMap(n))});var b=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],x=["applet","blockquote","body","button","div","dl","fieldset","form","frameset","h1","h2","h3","h4","h5","h6","head","html","iframe","layer","legend","object","ol","p","select","table","ul"];function r(e,t){for(var n=e.listSelections(),r=[],i=t?"/":"</",o=e.getOption("autoCloseTags"),o="object"==typeof o&&o.dontIndentOnSlash,a=0;a<n.length;a++){if(!n[a].empty())return y.Pass;var s=n[a].head,c=e.getTokenAt(s),l=y.innerMode(e.getMode(),c.state),f=l.state;if(t&&("string"==c.type||"<"!=c.string.charAt(0)||c.start!=s.ch-1))return y.Pass;var h,d="xml"!=l.mode.name&&"htmlmixed"==e.getMode().name;if(d&&"javascript"==l.mode.name)h=i+"script";else if(d&&"css"==l.mode.name)h=i+"style";else{d=l.mode.xmlCurrentContext&&l.mode.xmlCurrentContext(f),l=d.length?d[d.length-1]:"";if(!d||d.length&&C(e,d,l,s))return y.Pass;h=i+l}">"!=e.getLine(s.line).charAt(c.end)&&(h+=">"),r[a]=h}if(e.replaceSelections(r),n=e.listSelections(),!o)for(a=0;a<n.length;a++)(a==n.length-1||n[a].head.line<n[a+1].head.line)&&e.indentLine(n[a].head.line)}function k(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,r=e.length;n<r;++n)if(e[n]==t)return n;return-1}function C(e,t,n,r,i){if(y.scanForClosingTag){var o=Math.min(e.lastLine()+1,r.line+500),a=y.scanForClosingTag(e,r,null,o);if(a&&a.tag==n){for(var s=i?1:0,c=t.length-1;0<=c&&t[c]==n;c--)++s;r=a.to;for(c=1;c<s;c++){var l=y.scanForClosingTag(e,r,null,o);if(!l||l.tag!=n)return;r=l.to}return 1}}}y.commands.closeTag=function(e){return r(e)}}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(f){"use strict";var g=/^(\s*)(>[> ]*|[*+-] \[[x ]\]\s|[*+-]\s|(\d+)([.)]))(\s*)/,h=/^(\s*)(>[> ]*|[*+-] \[[x ]\]|[*+-]|(\d+)[.)])(\s*)$/,d=/[*+-]\s/;f.commands.newlineAndIndentContinueMarkdownList=function(e){if(e.getOption("disableInput"))return f.Pass;for(var t=e.listSelections(),n=[],r=0;r<t.length;r++){var i=t[r].head,o=e.getStateAfter(i.line),a=f.innerMode(e.getMode(),o);if("markdown"!==a.mode.name&&"markdown"!==a.mode.helperType)return void e.execCommand("newlineAndIndent");var a=!1!==(o=a.state).list,o=0!==o.quote,s=e.getLine(i.line),c=g.exec(s),l=/^\s*$/.test(s.slice(0,i.ch));if(!t[r].empty()||!a&&!o||!c||l)return void e.execCommand("newlineAndIndent");h.test(s)?(a=o&&/>\s*$/.test(s),l=!/>\s*$/.test(s),(a||l)&&e.replaceRange("",{line:i.line,ch:0},{line:i.line,ch:i.ch+1}),n[r]="\n"):(o=c[1],s=c[5],l=(a=!(d.test(c[2])||0<=c[2].indexOf(">")))?parseInt(c[3],10)+1+c[4]:c[2].replace("x"," "),n[r]="\n"+o+l+s,a&&function(e,t){var n=t.line,r=0,i=0,o=g.exec(e.getLine(n)),a=o[1];do{var s=n+(r+=1),c=e.getLine(s),l=g.exec(c);if(l){var f=l[1],h=parseInt(o[3],10)+r-i,d=parseInt(l[3],10),u=d;if(a!==f||isNaN(d)){if(a.length>f.length)return;if(a.length<f.length&&1===r)return;i+=1}else h===d&&(u=d+1),d<h&&(u=1+h),e.replaceRange(c.replace(g,f+u+l[4]+l[5]),{line:s,ch:0},{line:s,ch:c.length})}}while(l)}(e,i))}e.replaceSelections(n)}}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(r){var h=/MSIE \d/.test(navigator.userAgent)&&(null==document.documentMode||document.documentMode<8),p=r.Pos,v={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<","<":">>",">":"<<"};function y(e){return e&&e.bracketRegex||/[(){}[\]]/}function d(e,t,n){var r=e.getLineHandle(t.line),i=t.ch-1,o=n&&n.afterCursor,a=(null==o&&(o=/(^| )cm-fat-cursor($| )/.test(e.getWrapperElement().className)),y(n)),o=!o&&0<=i&&a.test(r.text.charAt(i))&&v[r.text.charAt(i)]||a.test(r.text.charAt(i+1))&&v[r.text.charAt(++i)];return!o||(a=">"==o.charAt(1)?1:-1,n&&n.strict&&0<a!=(i==t.ch))||(r=e.getTokenTypeAt(p(t.line,i+1)),null==(e=s(e,p(t.line,i+(0<a?1:0)),a,r,n)))?null:{from:p(t.line,i),to:e&&e.pos,match:e&&e.ch==o.charAt(0),forward:0<a}}function s(e,t,n,r,i){for(var o=i&&i.maxScanLineLength||1e4,a=i&&i.maxScanLines||1e3,s=[],c=y(i),l=0<n?Math.min(t.line+a,e.lastLine()+1):Math.max(e.firstLine()-1,t.line-a),f=t.line;f!=l;f+=n){var h=e.getLine(f);if(h){var d=0<n?0:h.length-1,u=0<n?h.length:-1;if(!(h.length>o))for(f==t.line&&(d=t.ch-(n<0?1:0));d!=u;d+=n){var g=h.charAt(d);if(c.test(g)&&(void 0===r||(e.getTokenTypeAt(p(f,d+1))||"")==(r||""))){var m=v[g];if(m&&">"==m.charAt(1)==0<n)s.push(g);else{if(!s.length)return{pos:p(f,d),ch:g};s.pop()}}}}}return f-n!=(0<n?e.lastLine():e.firstLine())&&null}function t(e,t,n){for(var r=e.state.matchBrackets.maxHighlightLineLength||1e3,i=n&&n.highlightNonMatching,o=[],a=e.listSelections(),s=0;s<a.length;s++){var c,l=a[s].empty()&&d(e,a[s].head,n);l&&(l.match||!1!==i)&&e.getLine(l.from.line).length<=r&&(c=l.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket",o.push(e.markText(l.from,p(l.from.line,l.from.ch+1),{className:c})),l.to)&&e.getLine(l.to.line).length<=r&&o.push(e.markText(l.to,p(l.to.line,l.to.ch+1),{className:c}))}if(o.length){h&&e.state.focused&&e.focus();function f(){e.operation(function(){for(var e=0;e<o.length;e++)o[e].clear()})}if(!t)return f;setTimeout(f,800)}}function i(e){e.operation(function(){e.state.matchBrackets.currentlyHighlighted&&(e.state.matchBrackets.currentlyHighlighted(),e.state.matchBrackets.currentlyHighlighted=null),e.state.matchBrackets.currentlyHighlighted=t(e,!1,e.state.matchBrackets)})}function o(e){e.state.matchBrackets&&e.state.matchBrackets.currentlyHighlighted&&(e.state.matchBrackets.currentlyHighlighted(),e.state.matchBrackets.currentlyHighlighted=null)}r.defineOption("matchBrackets",!1,function(e,t,n){n&&n!=r.Init&&(e.off("cursorActivity",i),e.off("focus",i),e.off("blur",o),o(e)),t&&(e.state.matchBrackets="object"==typeof t?t:{},e.on("cursorActivity",i),e.on("focus",i),e.on("blur",o))}),r.defineExtension("matchBrackets",function(){t(this,!0)}),r.defineExtension("findMatchingBracket",function(e,t,n){return d(this,e,t=!n&&"boolean"!=typeof t?t:n?(n.strict=t,n):t?{strict:!0}:null)}),r.defineExtension("scanForBracket",function(e,t,n,r){return s(this,e,t,n,r)})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("../fold/xml-fold")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../fold/xml-fold"],e):e(CodeMirror)}(function(r){"use strict";function i(e){e.state.tagHit&&e.state.tagHit.clear(),e.state.tagOther&&e.state.tagOther.clear(),e.state.tagHit=e.state.tagOther=null}function o(n){n.state.failedTagMatch=!1,n.operation(function(){var e,t;i(n),!n.somethingSelected()&&(e=n.getCursor(),(t=n.getViewport()).from=Math.min(t.from,e.line),t.to=Math.max(e.line+1,t.to),e=r.findMatchingTag(n,e,t))&&(n.state.matchBothTags&&(t="open"==e.at?e.open:e.close)&&(n.state.tagHit=n.markText(t.from,t.to,{className:"CodeMirror-matchingtag"})),(t="close"==e.at?e.open:e.close)?n.state.tagOther=n.markText(t.from,t.to,{className:"CodeMirror-matchingtag"}):n.state.failedTagMatch=!0)})}function a(e){e.state.failedTagMatch&&o(e)}r.defineOption("matchTags",!1,function(e,t,n){n&&n!=r.Init&&(e.off("cursorActivity",o),e.off("viewportChange",a),i(e)),t&&(e.state.matchBothTags="object"==typeof t&&t.bothTags,e.on("cursorActivity",o),e.on("viewportChange",a),o(e))}),r.commands.toMatchingTag=function(e){var t=r.findMatchingTag(e,e.getCursor());t&&(t="close"==t.at?t.open:t.close)&&e.extendSelection(t.to,t.from)}}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(r){r.defineOption("showTrailingSpace",!1,function(e,t,n){(n=n==r.Init?!1:n)&&!t?e.removeOverlay("trailingspace"):!n&&t&&e.addOverlay({token:function(e){for(var t=e.string.length,n=t;n&&/\s/.test(e.string.charAt(n-1));--n);return n>e.pos?(e.pos=n,null):(e.pos=t,"trailingspace")},name:"trailingspace"})})});